<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Abundance | Quantitative Ecology</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Abundance | Quantitative Ecology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Abundance | Quantitative Ecology" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Matt Weldy" />


<meta name="date" content="2021-09-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="occupancy.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script>
function unrolltab(evt, tabName) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(tabName).style.display = "block";
  evt.currentTarget.className += " active";
}
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative Ecology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Setup</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#setup-python"><i class="fa fa-check"></i><b>1.1</b> Setup Python</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#setup-julia"><i class="fa fa-check"></i><b>1.2</b> Setup Julia</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>2</b> Prerequisites</a></li>
<li class="chapter" data-level="3" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>3</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="intro.html"><a href="intro.html#probabilistic-modelling-in-ecology"><i class="fa fa-check"></i><b>3.1</b> Probabilistic Modelling in Ecology</a></li>
<li class="chapter" data-level="3.2" data-path="intro.html"><a href="intro.html#common-distributions"><i class="fa fa-check"></i><b>3.2</b> Common Distributions</a></li>
<li class="chapter" data-level="3.3" data-path="intro.html"><a href="intro.html#uncommon-distributions"><i class="fa fa-check"></i><b>3.3</b> Uncommon Distributions</a></li>
<li class="chapter" data-level="3.4" data-path="intro.html"><a href="intro.html#linear-models"><i class="fa fa-check"></i><b>3.4</b> Linear Models</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="intro.html"><a href="intro.html#model-of-the-mean"><i class="fa fa-check"></i><b>3.4.1</b> Model of the Mean</a></li>
<li class="chapter" data-level="3.4.2" data-path="intro.html"><a href="intro.html#difference-of-means"><i class="fa fa-check"></i><b>3.4.2</b> Difference of Means</a></li>
<li class="chapter" data-level="3.4.3" data-path="intro.html"><a href="intro.html#one-way-anova"><i class="fa fa-check"></i><b>3.4.3</b> One-way ANOVA</a></li>
<li class="chapter" data-level="3.4.4" data-path="intro.html"><a href="intro.html#one-way-anova-identity"><i class="fa fa-check"></i><b>3.4.4</b> One-way ANOVA Identity</a></li>
<li class="chapter" data-level="3.4.5" data-path="intro.html"><a href="intro.html#two-way-anova"><i class="fa fa-check"></i><b>3.4.5</b> Two-way ANOVA</a></li>
<li class="chapter" data-level="3.4.6" data-path="intro.html"><a href="intro.html#ancova"><i class="fa fa-check"></i><b>3.4.6</b> ANCOVA</a></li>
<li class="chapter" data-level="3.4.7" data-path="intro.html"><a href="intro.html#manova"><i class="fa fa-check"></i><b>3.4.7</b> MANOVA</a></li>
<li class="chapter" data-level="3.4.8" data-path="intro.html"><a href="intro.html#mancova"><i class="fa fa-check"></i><b>3.4.8</b> MANCOVA</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="intro.html"><a href="intro.html#common-priors"><i class="fa fa-check"></i><b>3.5</b> Common Priors</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="abundance.html"><a href="abundance.html"><i class="fa fa-check"></i><b>4</b> Abundance</a>
<ul>
<li class="chapter" data-level="4.1" data-path="abundance.html"><a href="abundance.html#lincoln-peterson"><i class="fa fa-check"></i><b>4.1</b> Lincoln-Peterson</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="abundance.html"><a href="abundance.html#algebra"><i class="fa fa-check"></i><b>4.1.1</b> Algebra</a></li>
<li class="chapter" data-level="4.1.2" data-path="abundance.html"><a href="abundance.html#simulation"><i class="fa fa-check"></i><b>4.1.2</b> Simulation</a></li>
<li class="chapter" data-level="4.1.3" data-path="abundance.html"><a href="abundance.html#models"><i class="fa fa-check"></i><b>4.1.3</b> Models</a></li>
<li class="chapter" data-level="4.1.4" data-path="abundance.html"><a href="abundance.html#comparison"><i class="fa fa-check"></i><b>4.1.4</b> Comparison</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="abundance.html"><a href="abundance.html#full-likelihood"><i class="fa fa-check"></i><b>4.2</b> Full Likelihood</a></li>
<li class="chapter" data-level="4.3" data-path="abundance.html"><a href="abundance.html#conditional-likelihood"><i class="fa fa-check"></i><b>4.3</b> Conditional Likelihood</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="abundance.html"><a href="abundance.html#algebra-1"><i class="fa fa-check"></i><b>4.3.1</b> Algebra</a></li>
<li class="chapter" data-level="4.3.2" data-path="abundance.html"><a href="abundance.html#simulation-1"><i class="fa fa-check"></i><b>4.3.2</b> Simulation</a></li>
<li class="chapter" data-level="4.3.3" data-path="abundance.html"><a href="abundance.html#models-1"><i class="fa fa-check"></i><b>4.3.3</b> Models</a></li>
<li class="chapter" data-level="4.3.4" data-path="abundance.html"><a href="abundance.html#comparison-1"><i class="fa fa-check"></i><b>4.3.4</b> Comparison</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="abundance.html"><a href="abundance.html#data-augmentation"><i class="fa fa-check"></i><b>4.4</b> Data Augmentation</a></li>
<li class="chapter" data-level="4.5" data-path="abundance.html"><a href="abundance.html#n-mixture-model"><i class="fa fa-check"></i><b>4.5</b> N-Mixture Model</a></li>
<li class="chapter" data-level="4.6" data-path="abundance.html"><a href="abundance.html#distance-sampling"><i class="fa fa-check"></i><b>4.6</b> Distance Sampling</a></li>
<li class="chapter" data-level="4.7" data-path="abundance.html"><a href="abundance.html#spatial-capture-recapture"><i class="fa fa-check"></i><b>4.7</b> Spatial Capture-Recapture</a></li>
<li class="chapter" data-level="4.8" data-path="abundance.html"><a href="abundance.html#time-to-event"><i class="fa fa-check"></i><b>4.8</b> Time to Event</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="occupancy.html"><a href="occupancy.html"><i class="fa fa-check"></i><b>5</b> Occupancy</a>
<ul>
<li class="chapter" data-level="5.1" data-path="occupancy.html"><a href="occupancy.html#static-single-season"><i class="fa fa-check"></i><b>5.1</b> Static Single Season</a></li>
<li class="chapter" data-level="5.2" data-path="occupancy.html"><a href="occupancy.html#multistate"><i class="fa fa-check"></i><b>5.2</b> Multistate</a></li>
<li class="chapter" data-level="5.3" data-path="occupancy.html"><a href="occupancy.html#multiscale"><i class="fa fa-check"></i><b>5.3</b> Multiscale</a></li>
<li class="chapter" data-level="5.4" data-path="occupancy.html"><a href="occupancy.html#multiscale-multistate"><i class="fa fa-check"></i><b>5.4</b> Multiscale Multistate</a></li>
<li class="chapter" data-level="5.5" data-path="occupancy.html"><a href="occupancy.html#species-cooccurrence"><i class="fa fa-check"></i><b>5.5</b> Species Cooccurrence</a></li>
<li class="chapter" data-level="5.6" data-path="occupancy.html"><a href="occupancy.html#dynamic-occupancy"><i class="fa fa-check"></i><b>5.6</b> Dynamic Occupancy</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="survival.html"><a href="survival.html"><i class="fa fa-check"></i><b>6</b> Survival</a>
<ul>
<li class="chapter" data-level="6.1" data-path="survival.html"><a href="survival.html#nest-survival"><i class="fa fa-check"></i><b>6.1</b> Nest Survival</a></li>
<li class="chapter" data-level="6.2" data-path="survival.html"><a href="survival.html#known-fate"><i class="fa fa-check"></i><b>6.2</b> Known-fate</a></li>
<li class="chapter" data-level="6.3" data-path="survival.html"><a href="survival.html#individual-level-cormack-jolly-seber"><i class="fa fa-check"></i><b>6.3</b> Individual-level Cormack-Jolly-Seber</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="survival.html"><a href="survival.html#algebra-2"><i class="fa fa-check"></i><b>6.3.1</b> Algebra</a></li>
<li class="chapter" data-level="6.3.2" data-path="survival.html"><a href="survival.html#simulation-2"><i class="fa fa-check"></i><b>6.3.2</b> Simulation</a></li>
<li class="chapter" data-level="6.3.3" data-path="survival.html"><a href="survival.html#models-2"><i class="fa fa-check"></i><b>6.3.3</b> Models</a></li>
<li class="chapter" data-level="6.3.4" data-path="survival.html"><a href="survival.html#comparison-2"><i class="fa fa-check"></i><b>6.3.4</b> Comparison</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="survival.html"><a href="survival.html#jolly-seber"><i class="fa fa-check"></i><b>6.4</b> Jolly-Seber</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-a.html"><a href="appendix-a.html"><i class="fa fa-check"></i><b>A</b> Appendix A</a>
<ul>
<li class="chapter" data-level="A.1" data-path="appendix-a.html"><a href="appendix-a.html#authors-guidelines"><i class="fa fa-check"></i><b>A.1</b> Authors Guidelines</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="appendix-b.html"><a href="appendix-b.html"><i class="fa fa-check"></i><b>B</b> Appendix B</a>
<ul>
<li class="chapter" data-level="B.1" data-path="appendix-b.html"><a href="appendix-b.html#model-template"><i class="fa fa-check"></i><b>B.1</b> Model Template</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="abundance" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Abundance</h1>
<div id="lincoln-peterson" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Lincoln-Peterson</h2>
<p>Lincoln 1930, Petersen 1896</p>
<p>The Lincoln-Petersen abundance estimator arises in cases where we have mark-recapture data recorded over two capture occasions. During the first occasion individuals are captured and uniquely marked. During the second occasion the number of individuals captured is recorded, along with the number of individuals marked during the first occasion that are recaptured.</p>
<div id="algebra" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Algebra</h3>
<p>The data consist of:</p>
<ul>
<li><span class="math inline">\(M_1\)</span> : the number of individuals captured and uniquely marked during the first occasion<br />
</li>
<li><span class="math inline">\(M_2\)</span> : the number of previously marked individuals captured during the second occasion<br />
</li>
<li><span class="math inline">\(C\)</span> : the number of animals captured during the second trapping occasion</li>
</ul>
<p><span class="math display">\[M_2 \sim Binomial(C, \frac{M_1}{\hat{N}}) \]</span>
<span class="math display">\[\mathcal{L}(C| M_1, p = \frac{M_1}{\hat{N}}) = {M_1 \choose C} p^C(1-p)^{M_1-C}\]</span>
The maximum likelihood estimate for <span class="math inline">\(\hat{N}\)</span> is,
<span class="math display">\[\hat{N} = \frac{M_1*C}{M_2}\]</span></p>
</div>
<div id="simulation" class="section level3 tabset" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Simulation</h3>
<div class="tab">
<button class="tablinks" onclick="unrolltab(event,&#39;R_LP_sim&#39;)">
R
</button>
<button class="tablinks" onclick="unrolltab(event,&#39;Python_LP_sim&#39;)">
Python
</button>
<button class="tablinks" onclick="unrolltab(event,&#39;Julia_LP_sim&#39;)">
Julia
</button>
<div id="R_LP_sim" class="tabcontent">
<div id="section" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="abundance.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb29-2"><a href="abundance.html#cb29-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">75</span> <span class="co"># True population size</span></span>
<span id="cb29-3"><a href="abundance.html#cb29-3" aria-hidden="true" tabindex="-1"></a>n_occ <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Number of trapping occasions</span></span>
<span id="cb29-4"><a href="abundance.html#cb29-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.50</span> <span class="co"># Probability of first detection</span></span>
<span id="cb29-5"><a href="abundance.html#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="abundance.html#cb29-6" aria-hidden="true" tabindex="-1"></a>true_detections <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(N, n_occ))</span>
<span id="cb29-7"><a href="abundance.html#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_occ) {</span>
<span id="cb29-8"><a href="abundance.html#cb29-8" aria-hidden="true" tabindex="-1"></a>  true_detections[, t] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> N, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> p)</span>
<span id="cb29-9"><a href="abundance.html#cb29-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-10"><a href="abundance.html#cb29-10" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> true_detections[<span class="fu">apply</span>(true_detections, <span class="dv">1</span>, max) <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb29-11"><a href="abundance.html#cb29-11" aria-hidden="true" tabindex="-1"></a>M_1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(observed[, <span class="dv">1</span>])</span>
<span id="cb29-12"><a href="abundance.html#cb29-12" aria-hidden="true" tabindex="-1"></a>M_2 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(<span class="fu">subset</span>(observed, <span class="fu">rowSums</span>(observed) <span class="sc">&gt;</span> <span class="dv">1</span>))</span>
<span id="cb29-13"><a href="abundance.html#cb29-13" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">sum</span>(observed[, <span class="dv">2</span>])</span>
<span id="cb29-14"><a href="abundance.html#cb29-14" aria-hidden="true" tabindex="-1"></a>M_2</span></code></pre></div>
</div>
</div>
<div id="Python_LP_sim" class="tabcontent">
<div id="section-1" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="abundance.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pymc3 <span class="im">import</span> <span class="op">*</span></span>
<span id="cb30-2"><a href="abundance.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pymc3 <span class="im">as</span> pm</span>
<span id="cb30-3"><a href="abundance.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy <span class="im">as</span> sp</span>
<span id="cb30-4"><a href="abundance.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-5"><a href="abundance.html#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb30-6"><a href="abundance.html#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display</span>
<span id="cb30-7"><a href="abundance.html#cb30-7" aria-hidden="true" tabindex="-1"></a>az.style.use(<span class="st">&quot;arviz-darkgrid&quot;</span>)</span>
<span id="cb30-8"><a href="abundance.html#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="abundance.html#cb30-9" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">75</span></span>
<span id="cb30-10"><a href="abundance.html#cb30-10" aria-hidden="true" tabindex="-1"></a>n_occ <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb30-11"><a href="abundance.html#cb30-11" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fl">.50</span></span>
<span id="cb30-12"><a href="abundance.html#cb30-12" aria-hidden="true" tabindex="-1"></a>true_detections <span class="op">=</span> sp.stats.bernoulli.rvs(p, size <span class="op">=</span> (N, n_occ))</span>
<span id="cb30-13"><a href="abundance.html#cb30-13" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> true_detections[<span class="op">~</span>np.<span class="bu">all</span>(true_detections <span class="op">==</span> <span class="dv">0</span>, axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb30-14"><a href="abundance.html#cb30-14" aria-hidden="true" tabindex="-1"></a>M1, C <span class="op">=</span> obs.<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb30-15"><a href="abundance.html#cb30-15" aria-hidden="true" tabindex="-1"></a>M2 <span class="op">=</span> np.shape(obs[ obs.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>) <span class="op">&gt;</span> <span class="dv">1</span>,])[<span class="dv">0</span>]</span></code></pre></div>
</div>
</div>
<div id="Julia_LP_sim" class="tabcontent">
<div id="section-2" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb31-1"><a href="abundance.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> Distributions<span class="op">,</span> MCMCChains<span class="op">,</span> <span class="bu">Random</span><span class="op">,</span> StatsPlots<span class="op">,</span> Turing</span>
<span id="cb31-2"><a href="abundance.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="abundance.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="bu">Random</span>.seed<span class="op">!</span>(<span class="fl">12</span>)</span>
<span id="cb31-4"><a href="abundance.html#cb31-4" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">150</span></span>
<span id="cb31-5"><a href="abundance.html#cb31-5" aria-hidden="true" tabindex="-1"></a>n_occ <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb31-6"><a href="abundance.html#cb31-6" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fl">.50</span></span>
<span id="cb31-7"><a href="abundance.html#cb31-7" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> <span class="dt">Float64</span>.(rand(length(p)) .<span class="op">&lt;</span> p)</span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="models" class="section level3 tabset" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Models</h3>
<div class="tab">
<button class="tablinks" onclick="unrolltab(event,&#39;JAGS_LP_mod&#39;)">
JAGS
</button>
<button class="tablinks" onclick="unrolltab(event,&#39;NIMBLE_LP_mod&#39;)">
NIMBLE
</button>
<button class="tablinks" onclick="unrolltab(event,&#39;Stan_LP_mod&#39;)">
Stan
</button>
<button class="tablinks" onclick="unrolltab(event,&#39;Greta_LP_mod&#39;)">
Greta
</button>
<button class="tablinks" onclick="unrolltab(event,&#39;Pymc3_LP_mod&#39;)">
Pymc3
</button>
<button class="tablinks" onclick="unrolltab(event,&#39;Turing_LP_mod&#39;)">
Pymc3
</button>
<div id="JAGS_LP_mod" class="tabcontent">
<div id="section-3" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="abundance.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb32-2"><a href="abundance.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb32-3"><a href="abundance.html#cb32-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb32-4"><a href="abundance.html#cb32-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">M_1 =</span> M_1,</span>
<span id="cb32-5"><a href="abundance.html#cb32-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">M_2=</span> M_2,</span>
<span id="cb32-6"><a href="abundance.html#cb32-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">C =</span> C,</span>
<span id="cb32-7"><a href="abundance.html#cb32-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">LB =</span> C<span class="sc">-</span> M_1 <span class="sc">+</span> M_2,</span>
<span id="cb32-8"><a href="abundance.html#cb32-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">UB =</span> <span class="dv">5</span><span class="sc">*</span>C</span>
<span id="cb32-9"><a href="abundance.html#cb32-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-10"><a href="abundance.html#cb32-10" aria-hidden="true" tabindex="-1"></a>model_string <span class="ot">&lt;-</span> <span class="fu">textConnection</span>(</span>
<span id="cb32-11"><a href="abundance.html#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;</span></span>
<span id="cb32-12"><a href="abundance.html#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="st">  model {</span></span>
<span id="cb32-13"><a href="abundance.html#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb32-14"><a href="abundance.html#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="st">  # Likelihood</span></span>
<span id="cb32-15"><a href="abundance.html#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="st">  M_2 ~ dbin(M_1/N, C )</span></span>
<span id="cb32-16"><a href="abundance.html#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="st">  # Priors</span></span>
<span id="cb32-17"><a href="abundance.html#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="st">  N ~ dunif(LB, UB) # Slightly informative prior</span></span>
<span id="cb32-18"><a href="abundance.html#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="abundance.html#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="st">  # Derived values</span></span>
<span id="cb32-20"><a href="abundance.html#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb32-21"><a href="abundance.html#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb32-22"><a href="abundance.html#cb32-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-23"><a href="abundance.html#cb32-23" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;N&quot;</span>)</span>
<span id="cb32-24"><a href="abundance.html#cb32-24" aria-hidden="true" tabindex="-1"></a>set_initial_value <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb32-25"><a href="abundance.html#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>( </span>
<span id="cb32-26"><a href="abundance.html#cb32-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-27"><a href="abundance.html#cb32-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-28"><a href="abundance.html#cb32-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-29"><a href="abundance.html#cb32-29" aria-hidden="true" tabindex="-1"></a>ni <span class="ot">&lt;-</span> <span class="dv">10000</span> ; nt <span class="ot">&lt;-</span> <span class="dv">1</span> ; nb <span class="ot">&lt;-</span> <span class="dv">5000</span> ; nc <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb32-30"><a href="abundance.html#cb32-30" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">jags</span>(data, set_initial_value, parameters, model_string, <span class="at">n.chains =</span> nc, <span class="at">n.thin =</span> nt, <span class="at">n.iter =</span> ni, <span class="at">n.burnin =</span> nb)</span></code></pre></div>
</div>
</div>
<div id="NIMBLE_LP_mod" class="tabcontent">
<div id="section-4" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="abundance.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nimble)</span>
<span id="cb33-2"><a href="abundance.html#cb33-2" aria-hidden="true" tabindex="-1"></a>n_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb33-3"><a href="abundance.html#cb33-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">M_1 =</span> M_1,</span>
<span id="cb33-4"><a href="abundance.html#cb33-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">M_2=</span> M_2,</span>
<span id="cb33-5"><a href="abundance.html#cb33-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">C =</span> C</span>
<span id="cb33-6"><a href="abundance.html#cb33-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-7"><a href="abundance.html#cb33-7" aria-hidden="true" tabindex="-1"></a>n_constants <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb33-8"><a href="abundance.html#cb33-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">LB =</span> C<span class="sc">-</span> M_1 <span class="sc">+</span> M_2,</span>
<span id="cb33-9"><a href="abundance.html#cb33-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">UB =</span> <span class="dv">5</span><span class="sc">*</span>C</span>
<span id="cb33-10"><a href="abundance.html#cb33-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-11"><a href="abundance.html#cb33-11" aria-hidden="true" tabindex="-1"></a>Nimble_Code <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb33-12"><a href="abundance.html#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Likelihood</span></span>
<span id="cb33-13"><a href="abundance.html#cb33-13" aria-hidden="true" tabindex="-1"></a>  M_2 <span class="sc">~</span> <span class="fu">dbin</span>(M_1<span class="sc">/</span>N, C )</span>
<span id="cb33-14"><a href="abundance.html#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Priors</span></span>
<span id="cb33-15"><a href="abundance.html#cb33-15" aria-hidden="true" tabindex="-1"></a>  N <span class="sc">~</span> <span class="fu">dunif</span>(LB, UB) <span class="co"># Slightly informative prior</span></span>
<span id="cb33-16"><a href="abundance.html#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="abundance.html#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Derived values</span></span>
<span id="cb33-18"><a href="abundance.html#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="abundance.html#cb33-19" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb33-20"><a href="abundance.html#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="abundance.html#cb33-21" aria-hidden="true" tabindex="-1"></a>n_params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;N&quot;</span>)</span>
<span id="cb33-22"><a href="abundance.html#cb33-22" aria-hidden="true" tabindex="-1"></a>n_inits <span class="ot">&lt;-</span> <span class="fu">list</span>( </span>
<span id="cb33-23"><a href="abundance.html#cb33-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-24"><a href="abundance.html#cb33-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-25"><a href="abundance.html#cb33-25" aria-hidden="true" tabindex="-1"></a>Nimble_Model <span class="ot">&lt;-</span> <span class="fu">nimbleModel</span>(</span>
<span id="cb33-26"><a href="abundance.html#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">code =</span> Nimble_Code,</span>
<span id="cb33-27"><a href="abundance.html#cb33-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">constants =</span> n_constants,</span>
<span id="cb33-28"><a href="abundance.html#cb33-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> n_data,</span>
<span id="cb33-29"><a href="abundance.html#cb33-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">inits =</span> n_inits</span>
<span id="cb33-30"><a href="abundance.html#cb33-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-31"><a href="abundance.html#cb33-31" aria-hidden="true" tabindex="-1"></a>MCMC_Model <span class="ot">&lt;-</span> <span class="fu">configureMCMC</span>(Nimble_Model, <span class="at">monitors =</span> n_params, <span class="at">print =</span> T, <span class="at">enableWAIC =</span> F)</span>
<span id="cb33-32"><a href="abundance.html#cb33-32" aria-hidden="true" tabindex="-1"></a>Model1_MCMC <span class="ot">&lt;-</span> <span class="fu">buildMCMC</span>(MCMC_Model)</span>
<span id="cb33-33"><a href="abundance.html#cb33-33" aria-hidden="true" tabindex="-1"></a>Comp_Model <span class="ot">&lt;-</span> <span class="fu">compileNimble</span>( Nimble_Model, <span class="at">showCompilerOutput =</span> <span class="cn">TRUE</span> )</span>
<span id="cb33-34"><a href="abundance.html#cb33-34" aria-hidden="true" tabindex="-1"></a>Comp_Model <span class="ot">&lt;-</span> <span class="fu">compileNimble</span>(Model1_MCMC, <span class="at">project =</span> Nimble_Model)</span>
<span id="cb33-35"><a href="abundance.html#cb33-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-36"><a href="abundance.html#cb33-36" aria-hidden="true" tabindex="-1"></a>niter<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb33-37"><a href="abundance.html#cb33-37" aria-hidden="true" tabindex="-1"></a>Model_samples <span class="ot">&lt;-</span> <span class="fu">runMCMC</span>(Comp_Model, <span class="at">niter =</span> niter, <span class="at">nburnin=</span>niter<span class="sc">/</span><span class="dv">2</span>,<span class="at">nchains=</span><span class="dv">3</span>,<span class="at">summary =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-38"><a href="abundance.html#cb33-38" aria-hidden="true" tabindex="-1"></a><span class="co"># mcmc_combo(Model_samples$samples, pars = c(&quot;N&quot;, &quot;p&quot;))</span></span>
<span id="cb33-39"><a href="abundance.html#cb33-39" aria-hidden="true" tabindex="-1"></a><span class="co"># round(Model_samples$summary$all.chains,2)</span></span>
<span id="cb33-40"><a href="abundance.html#cb33-40" aria-hidden="true" tabindex="-1"></a>H</span></code></pre></div>
</div>
</div>
<div id="Stan_LP_mod" class="tabcontent">
<div id="section-5" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="abundance.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb34-2"><a href="abundance.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb34-3"><a href="abundance.html#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="abundance.html#cb34-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb34-5"><a href="abundance.html#cb34-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">M_1 =</span> M_1,</span>
<span id="cb34-6"><a href="abundance.html#cb34-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">M_2=</span> M_2,</span>
<span id="cb34-7"><a href="abundance.html#cb34-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">C =</span> C</span>
<span id="cb34-8"><a href="abundance.html#cb34-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-9"><a href="abundance.html#cb34-9" aria-hidden="true" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb34-10"><a href="abundance.html#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb34-11"><a href="abundance.html#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; M_1;</span></span>
<span id="cb34-12"><a href="abundance.html#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; M_2;</span></span>
<span id="cb34-13"><a href="abundance.html#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; C;</span></span>
<span id="cb34-14"><a href="abundance.html#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb34-15"><a href="abundance.html#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb34-16"><a href="abundance.html#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=(C - M_2 + M_1)&gt; N;</span></span>
<span id="cb34-17"><a href="abundance.html#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb34-18"><a href="abundance.html#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb34-19"><a href="abundance.html#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="st">  M_2 ~ binomial(C, M_1 / N);</span></span>
<span id="cb34-20"><a href="abundance.html#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb34-21"><a href="abundance.html#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb34-22"><a href="abundance.html#cb34-22" aria-hidden="true" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb34-23"><a href="abundance.html#cb34-23" aria-hidden="true" tabindex="-1"></a>stan.samples <span class="ot">&lt;-</span> <span class="fu">stan</span>(<span class="at">model_code =</span> stan_model, <span class="at">data =</span> data, <span class="at">iter =</span> <span class="dv">10000</span>, <span class="at">chains =</span> nc, <span class="at">cores =</span> nc)</span></code></pre></div>
</div>
</div>
<div id="Greta_LP_mod" class="tabcontent">
<div id="section-6" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="abundance.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(greta)</span>
<span id="cb35-2"><a href="abundance.html#cb35-2" aria-hidden="true" tabindex="-1"></a>LB <span class="ot">&lt;-</span> C<span class="sc">-</span> M_1 <span class="sc">+</span> M_2</span>
<span id="cb35-3"><a href="abundance.html#cb35-3" aria-hidden="true" tabindex="-1"></a>UB <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">*</span>C</span>
<span id="cb35-4"><a href="abundance.html#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># priors</span></span>
<span id="cb35-5"><a href="abundance.html#cb35-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">uniform</span>(LB,UB)</span>
<span id="cb35-6"><a href="abundance.html#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood</span></span>
<span id="cb35-7"><a href="abundance.html#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">distribution</span>(M_2) <span class="ot">&lt;-</span> <span class="fu">binomial</span>(C, M_1 <span class="sc">/</span> N)</span>
<span id="cb35-8"><a href="abundance.html#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co"># derived parameter</span></span>
<span id="cb35-9"><a href="abundance.html#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="abundance.html#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># defining the model</span></span>
<span id="cb35-11"><a href="abundance.html#cb35-11" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">model</span>(N) <span class="co">#objects to sample</span></span>
<span id="cb35-12"><a href="abundance.html#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co"># sampling</span></span>
<span id="cb35-13"><a href="abundance.html#cb35-13" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> greta<span class="sc">::</span><span class="fu">mcmc</span>(m, <span class="at">n_samples =</span> <span class="dv">1000</span>)</span></code></pre></div>
</div>
</div>
<div id="Pymc3_LP_mod" class="tabcontent">
<div id="section-7" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="abundance.html#cb36-1" aria-hidden="true" tabindex="-1"></a>LB <span class="op">=</span> C <span class="op">-</span> M1 <span class="op">+</span> M2</span>
<span id="cb36-2"><a href="abundance.html#cb36-2" aria-hidden="true" tabindex="-1"></a>UB <span class="op">=</span> <span class="dv">5</span><span class="op">*</span>C</span>
<span id="cb36-3"><a href="abundance.html#cb36-3" aria-hidden="true" tabindex="-1"></a>trials <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb36-4"><a href="abundance.html#cb36-4" aria-hidden="true" tabindex="-1"></a>LB</span>
<span id="cb36-5"><a href="abundance.html#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> Model() <span class="im">as</span> model:  </span>
<span id="cb36-6"><a href="abundance.html#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Priors for unknown model parameters</span></span>
<span id="cb36-7"><a href="abundance.html#cb36-7" aria-hidden="true" tabindex="-1"></a>    N_prior <span class="op">=</span> pm.Uniform(name <span class="op">=</span> <span class="st">&quot;N&quot;</span>, lower <span class="op">=</span> LB, upper <span class="op">=</span> UB)</span>
<span id="cb36-8"><a href="abundance.html#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Likelihood (sampling distribution) of observations</span></span>
<span id="cb36-9"><a href="abundance.html#cb36-9" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> pm.Binomial(name <span class="op">=</span> <span class="st">&quot;N_hat&quot;</span>, p <span class="op">=</span> M1<span class="op">/</span>N_prior, observed <span class="op">=</span> M2, n <span class="op">=</span> C)</span>
<span id="cb36-10"><a href="abundance.html#cb36-10" aria-hidden="true" tabindex="-1"></a>    trace <span class="op">=</span> pm.sample()<span class="op">;</span></span>
<span id="cb36-11"><a href="abundance.html#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="abundance.html#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> model:     </span>
<span id="cb36-13"><a href="abundance.html#cb36-13" aria-hidden="true" tabindex="-1"></a>  display(az.summary(trace, round_to <span class="op">=</span> <span class="dv">2</span>))<span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="abundance.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> model:     </span>
<span id="cb37-2"><a href="abundance.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  display(az.summary(trace, round_to <span class="op">=</span> <span class="dv">2</span>))<span class="op">;</span></span></code></pre></div>
</div>
</div>
<div id="Turing_mod" class="tabcontent">
<div id="section-8" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb38-1"><a href="abundance.html#cb38-1" aria-hidden="true" tabindex="-1"></a>with Model() as model<span class="op">:</span>  <span class="co"># model specifications in PyMC3 are wrapped in a with-statement</span></span>
<span id="cb38-2"><a href="abundance.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Priors for unknown model parameters</span></span>
<span id="cb38-3"><a href="abundance.html#cb38-3" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> pm.Uniform(<span class="ch">&#39;p&#39;</span><span class="op">,</span> <span class="fl">0</span>.<span class="op">,</span> <span class="fl">1</span>.)</span>
<span id="cb38-4"><a href="abundance.html#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Likelihood (sampling distribution) of observations</span></span>
<span id="cb38-5"><a href="abundance.html#cb38-5" aria-hidden="true" tabindex="-1"></a>    pstar <span class="op">=</span>  <span class="fl">1</span><span class="op">-</span>(<span class="fl">1</span><span class="op">-</span>p)<span class="op">*</span>(<span class="fl">1</span><span class="op">-</span>p)<span class="op">*</span>(<span class="fl">1</span><span class="op">-</span>p)<span class="op">*</span>(<span class="fl">1</span><span class="op">-</span>p)</span>
<span id="cb38-6"><a href="abundance.html#cb38-6" aria-hidden="true" tabindex="-1"></a>    N_hat <span class="op">=</span>  pm.Deterministic(<span class="st">&quot;N_hat&quot;</span><span class="op">,</span> MNKA <span class="op">/</span> pstar)</span>
<span id="cb38-7"><a href="abundance.html#cb38-7" aria-hidden="true" tabindex="-1"></a>    Y_obs <span class="op">=</span> pm.Bernoulli(<span class="st">&quot;Y_obs&quot;</span><span class="op">,</span> p <span class="op">=</span> p<span class="op">,</span> observed<span class="op">=</span>Y)</span>
<span id="cb38-8"><a href="abundance.html#cb38-8" aria-hidden="true" tabindex="-1"></a>    trace <span class="op">=</span> pm.sample()</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb39-1"><a href="abundance.html#cb39-1" aria-hidden="true" tabindex="-1"></a>with model<span class="op">:</span>     </span>
<span id="cb39-2"><a href="abundance.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  display(az.summary(trace<span class="op">,</span> round_to <span class="op">=</span> <span class="fl">2</span>))</span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="comparison" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Comparison</h3>
</div>
</div>
<div id="full-likelihood" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Full Likelihood</h2>
</div>
<div id="conditional-likelihood" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Conditional Likelihood</h2>
<p>The conditional likelihood abundance estimator proposed by <span class="citation"><a href="#ref-huggins_statistical_1989" role="doc-biblioref">Huggins</a> (<a href="#ref-huggins_statistical_1989" role="doc-biblioref">1989</a>)</span> and <span class="citation"><a href="#ref-alho_logistic_1990" role="doc-biblioref">Alho</a> (<a href="#ref-alho_logistic_1990" role="doc-biblioref">1990</a>)</span>, which was further extended in <span class="citation"><a href="#ref-huggins_practical_1991" role="doc-biblioref">Huggins</a> (<a href="#ref-huggins_practical_1991" role="doc-biblioref">1991</a>)</span>, is an extension to previous abundance estimators to account for heterogeneous capture probabilities (<span class="math inline">\(p\)</span>). The model estimates individual capture probabilities and abundance conditional on captured individuals.</p>
<div id="algebra-1" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Algebra</h3>
<p>The capture history <span class="math inline">\(y_{i,t}\)</span> is used to estimate the capture probability of individual <span class="math inline">\(i\)</span> as a Bernoulli trial,
<span class="math display">\[y_{i,t} \sim Bernoulli(p_{i,t})\]</span>
<span class="math display">\[\mathcal{L}(p| y) = \prod_{i=1}^n \prod_{t=1}^t p_{i,t}^{z_{i,t}}(1-p_{i,t})^{1-z_{i,t}}\]</span></p>
<p>Abundance <span class="math inline">\(\hat{N}\)</span> is derived conditional on the count of known individuals (<span class="math inline">\(C\)</span>), sometimes referred to the minimum number of known alive (<span class="math inline">\(MNKA\)</span>).
<span class="math display">\[\hat{N} = \frac{C}{1-\prod^{t}(1-p_t)}\]</span>
Variation in detection probability can be modeled using linear logistic models or other variations used to estimate probabilities 0-1.</p>
</div>
<div id="simulation-1" class="section level3 tabset" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Simulation</h3>
<div class="tab">
<button class="tablinks" onclick="unrolltab(event,&#39;R_Huggins_sim&#39;)">
R
</button>
<button class="tablinks" onclick="unrolltab(event,&#39;Python_Huggins_sim&#39;)">
Python
</button>
<button class="tablinks" onclick="unrolltab(event,&#39;Julia_Huggins_sim&#39;)">
Julia
</button>
<div id="R_Huggins_sim" class="tabcontent">
<div id="section-9" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="abundance.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb40-2"><a href="abundance.html#cb40-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">150</span> <span class="co">#True population size</span></span>
<span id="cb40-3"><a href="abundance.html#cb40-3" aria-hidden="true" tabindex="-1"></a>n_occ <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#Number of trapping occasions</span></span>
<span id="cb40-4"><a href="abundance.html#cb40-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.50</span> <span class="co">#Probability of first detection</span></span>
<span id="cb40-5"><a href="abundance.html#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="abundance.html#cb40-6" aria-hidden="true" tabindex="-1"></a>true_detections <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(N,n_occ))</span>
<span id="cb40-7"><a href="abundance.html#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_occ){</span>
<span id="cb40-8"><a href="abundance.html#cb40-8" aria-hidden="true" tabindex="-1"></a>  true_detections[,t] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span>N,<span class="at">size=</span><span class="dv">1</span>,<span class="at">prob=</span>p)</span>
<span id="cb40-9"><a href="abundance.html#cb40-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-10"><a href="abundance.html#cb40-10" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> true_detections[<span class="fu">apply</span>(true_detections,<span class="dv">1</span>,max) <span class="sc">==</span> <span class="dv">1</span>,]</span>
<span id="cb40-11"><a href="abundance.html#cb40-11" aria-hidden="true" tabindex="-1"></a>MNKA <span class="ot">&lt;-</span> <span class="fu">nrow</span>(observed)</span>
<span id="cb40-12"><a href="abundance.html#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">paste0</span>(<span class="st">&quot;Number ever detected: &quot;</span>, MNKA,<span class="at">sep =</span> <span class="st">&quot; &quot;</span>) ) <span class="co">#number ever detected</span></span></code></pre></div>
</div>
</div>
<div id="Python_Huggins_sim" class="tabcontent">
<div id="section-10" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="abundance.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pymc3 <span class="im">import</span> <span class="op">*</span></span>
<span id="cb41-2"><a href="abundance.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy <span class="im">as</span> sp</span>
<span id="cb41-3"><a href="abundance.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb41-4"><a href="abundance.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb41-5"><a href="abundance.html#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display</span>
<span id="cb41-6"><a href="abundance.html#cb41-6" aria-hidden="true" tabindex="-1"></a>az.style.use(<span class="st">&quot;arviz-darkgrid&quot;</span>)</span>
<span id="cb41-7"><a href="abundance.html#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="abundance.html#cb41-8" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">150</span></span>
<span id="cb41-9"><a href="abundance.html#cb41-9" aria-hidden="true" tabindex="-1"></a>n_occ <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb41-10"><a href="abundance.html#cb41-10" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fl">.50</span></span>
<span id="cb41-11"><a href="abundance.html#cb41-11" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> sp.stats.bernoulli.rvs(p, size <span class="op">=</span> (N, n_occ))</span>
<span id="cb41-12"><a href="abundance.html#cb41-12" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> Y[<span class="op">~</span>np.<span class="bu">all</span>(Y <span class="op">==</span> <span class="dv">0</span>, axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb41-13"><a href="abundance.html#cb41-13" aria-hidden="true" tabindex="-1"></a>MNKA <span class="op">=</span> <span class="bu">len</span>(obs)</span></code></pre></div>
</div>
</div>
<div id="Julia_Huggins_sim" class="tabcontent">
<div id="section-11" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode julia"><code class="sourceCode julia"></code></pre></div>
</div>
</div>
</div>
</div>
<div id="models-1" class="section level3 tabset" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Models</h3>
<div class="tab">
<button class="tablinks" onclick="unrolltab(event,&#39;JAGS_Huggins_mod&#39;)">
JAGS
</button>
<button class="tablinks" onclick="unrolltab(event,&#39;NIMBLE_Huggins_mod&#39;)">
NIMBLE
</button>
<button class="tablinks" onclick="unrolltab(event,&#39;Stan_Huggins_mod&#39;)">
Stan
</button>
<button class="tablinks" onclick="unrolltab(event,&#39;Greta_Huggins_mod&#39;)">
Greta
</button>
<button class="tablinks" onclick="unrolltab(event,&#39;Pymc3_LP_mod&#39;)">
Pymc3
</button>
<button class="tablinks" onclick="unrolltab(event,&#39;Turing_LP_mod&#39;)">
Pymc3
</button>
<div id="JAGS_Huggins_mod" class="tabcontent">
<div id="section-12" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="abundance.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb43-2"><a href="abundance.html#cb43-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb43-3"><a href="abundance.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span>observed,</span>
<span id="cb43-4"><a href="abundance.html#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_sites=</span><span class="fu">nrow</span>(observed),</span>
<span id="cb43-5"><a href="abundance.html#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">MNKA=</span>MNKA,</span>
<span id="cb43-6"><a href="abundance.html#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_occ=</span>n_occ</span>
<span id="cb43-7"><a href="abundance.html#cb43-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-8"><a href="abundance.html#cb43-8" aria-hidden="true" tabindex="-1"></a>model_string <span class="ot">&lt;-</span> <span class="fu">textConnection</span>(</span>
<span id="cb43-9"><a href="abundance.html#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;</span></span>
<span id="cb43-10"><a href="abundance.html#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="st">  model {</span></span>
<span id="cb43-11"><a href="abundance.html#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="st">  # Likelihood</span></span>
<span id="cb43-12"><a href="abundance.html#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="st">  for(i in 1:n_sites) {</span></span>
<span id="cb43-13"><a href="abundance.html#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="st">    # Observation model</span></span>
<span id="cb43-14"><a href="abundance.html#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="st">    for(j in 1:n_occ) {</span></span>
<span id="cb43-15"><a href="abundance.html#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="st">      y[i, j] ~ dbern(p)</span></span>
<span id="cb43-16"><a href="abundance.html#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb43-17"><a href="abundance.html#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb43-18"><a href="abundance.html#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="st">  for(t in 1:n_occ){</span></span>
<span id="cb43-19"><a href="abundance.html#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="st">    p_un[t] &lt;- (1-p)</span></span>
<span id="cb43-20"><a href="abundance.html#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb43-21"><a href="abundance.html#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="st">  # Priors</span></span>
<span id="cb43-22"><a href="abundance.html#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="st">  p ~ dunif(0, 1) # Uninformative prior</span></span>
<span id="cb43-23"><a href="abundance.html#cb43-23" aria-hidden="true" tabindex="-1"></a><span class="st">  # Derived values</span></span>
<span id="cb43-24"><a href="abundance.html#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="st">  N &lt;- (MNKA / (1-prod(p_un[])))</span></span>
<span id="cb43-25"><a href="abundance.html#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="st">}&quot;</span>)</span>
<span id="cb43-26"><a href="abundance.html#cb43-26" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;p&quot;</span>,<span class="st">&quot;N&quot;</span>)</span>
<span id="cb43-27"><a href="abundance.html#cb43-27" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb43-28"><a href="abundance.html#cb43-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>( </span>
<span id="cb43-29"><a href="abundance.html#cb43-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-30"><a href="abundance.html#cb43-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-31"><a href="abundance.html#cb43-31" aria-hidden="true" tabindex="-1"></a>ni <span class="ot">&lt;-</span> <span class="dv">10000</span> ; nt <span class="ot">&lt;-</span> <span class="dv">1</span> ; nc <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb43-32"><a href="abundance.html#cb43-32" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data =</span> data, </span>
<span id="cb43-33"><a href="abundance.html#cb43-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">inits =</span> inits, </span>
<span id="cb43-34"><a href="abundance.html#cb43-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">parameters =</span> parameters, </span>
<span id="cb43-35"><a href="abundance.html#cb43-35" aria-hidden="true" tabindex="-1"></a>              <span class="at">model.file =</span> model_string, </span>
<span id="cb43-36"><a href="abundance.html#cb43-36" aria-hidden="true" tabindex="-1"></a>              <span class="at">n.chains =</span> nc, </span>
<span id="cb43-37"><a href="abundance.html#cb43-37" aria-hidden="true" tabindex="-1"></a>              <span class="at">n.thin =</span> nt, </span>
<span id="cb43-38"><a href="abundance.html#cb43-38" aria-hidden="true" tabindex="-1"></a>              <span class="at">n.iter =</span> ni, </span>
<span id="cb43-39"><a href="abundance.html#cb43-39" aria-hidden="true" tabindex="-1"></a>              <span class="at">n.burnin =</span> ni<span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
</div>
</div>
<div id="NIMBLE_Huggins_mod" class="tabcontent">
<div id="section-13" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="abundance.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nimble)</span>
<span id="cb44-2"><a href="abundance.html#cb44-2" aria-hidden="true" tabindex="-1"></a>n_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb44-3"><a href="abundance.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> observed,</span>
<span id="cb44-4"><a href="abundance.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">MNKA =</span> MNKA</span>
<span id="cb44-5"><a href="abundance.html#cb44-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-6"><a href="abundance.html#cb44-6" aria-hidden="true" tabindex="-1"></a>n_constants <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb44-7"><a href="abundance.html#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_occ =</span> n_occ</span>
<span id="cb44-8"><a href="abundance.html#cb44-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-9"><a href="abundance.html#cb44-9" aria-hidden="true" tabindex="-1"></a>Nimble_Code <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb44-10"><a href="abundance.html#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Likelihood</span></span>
<span id="cb44-11"><a href="abundance.html#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>MNKA) {</span>
<span id="cb44-12"><a href="abundance.html#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Observation model</span></span>
<span id="cb44-13"><a href="abundance.html#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_occ) {</span>
<span id="cb44-14"><a href="abundance.html#cb44-14" aria-hidden="true" tabindex="-1"></a>      y[i, j] <span class="sc">~</span> <span class="fu">dbern</span>(p)</span>
<span id="cb44-15"><a href="abundance.html#cb44-15" aria-hidden="true" tabindex="-1"></a>    } <span class="co">#j</span></span>
<span id="cb44-16"><a href="abundance.html#cb44-16" aria-hidden="true" tabindex="-1"></a>  } <span class="co">#i</span></span>
<span id="cb44-17"><a href="abundance.html#cb44-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-18"><a href="abundance.html#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Priors</span></span>
<span id="cb44-19"><a href="abundance.html#cb44-19" aria-hidden="true" tabindex="-1"></a>  p <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># Uninformative prior</span></span>
<span id="cb44-20"><a href="abundance.html#cb44-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-21"><a href="abundance.html#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Derived values</span></span>
<span id="cb44-22"><a href="abundance.html#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_occ){</span>
<span id="cb44-23"><a href="abundance.html#cb44-23" aria-hidden="true" tabindex="-1"></a>    p_un[t] <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>p)</span>
<span id="cb44-24"><a href="abundance.html#cb44-24" aria-hidden="true" tabindex="-1"></a>  } <span class="co">#t</span></span>
<span id="cb44-25"><a href="abundance.html#cb44-25" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> (MNKA <span class="sc">/</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">prod</span>(p_un[<span class="dv">1</span><span class="sc">:</span>n_occ]))) <span class="co">#The only difference in this model is here declaring dimensions</span></span>
<span id="cb44-26"><a href="abundance.html#cb44-26" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb44-27"><a href="abundance.html#cb44-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-28"><a href="abundance.html#cb44-28" aria-hidden="true" tabindex="-1"></a>n_params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;N&quot;</span>)</span>
<span id="cb44-29"><a href="abundance.html#cb44-29" aria-hidden="true" tabindex="-1"></a>n_inits <span class="ot">&lt;-</span> <span class="fu">list</span>( </span>
<span id="cb44-30"><a href="abundance.html#cb44-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-31"><a href="abundance.html#cb44-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-32"><a href="abundance.html#cb44-32" aria-hidden="true" tabindex="-1"></a>Nimble_Model <span class="ot">&lt;-</span> <span class="fu">nimbleModel</span>(</span>
<span id="cb44-33"><a href="abundance.html#cb44-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">code =</span> Nimble_Code,</span>
<span id="cb44-34"><a href="abundance.html#cb44-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">constants =</span> n_constants,</span>
<span id="cb44-35"><a href="abundance.html#cb44-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> n_data,</span>
<span id="cb44-36"><a href="abundance.html#cb44-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">inits =</span> n_inits</span>
<span id="cb44-37"><a href="abundance.html#cb44-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-38"><a href="abundance.html#cb44-38" aria-hidden="true" tabindex="-1"></a>MCMC_Model <span class="ot">&lt;-</span> <span class="fu">configureMCMC</span>(Nimble_Model, <span class="at">monitors =</span> n_params, <span class="at">print =</span> T, <span class="at">enableWAIC =</span> F)</span>
<span id="cb44-39"><a href="abundance.html#cb44-39" aria-hidden="true" tabindex="-1"></a>Model1_MCMC <span class="ot">&lt;-</span> <span class="fu">buildMCMC</span>(MCMC_Model)</span>
<span id="cb44-40"><a href="abundance.html#cb44-40" aria-hidden="true" tabindex="-1"></a>Comp_Model <span class="ot">&lt;-</span> <span class="fu">compileNimble</span>( Nimble_Model, <span class="at">showCompilerOutput =</span> <span class="cn">TRUE</span> )</span>
<span id="cb44-41"><a href="abundance.html#cb44-41" aria-hidden="true" tabindex="-1"></a>Comp_Model <span class="ot">&lt;-</span> <span class="fu">compileNimble</span>(Model1_MCMC, <span class="at">project =</span> Nimble_Model)</span>
<span id="cb44-42"><a href="abundance.html#cb44-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-43"><a href="abundance.html#cb44-43" aria-hidden="true" tabindex="-1"></a>ni <span class="ot">&lt;-</span> <span class="dv">10000</span> ; nt <span class="ot">&lt;-</span> <span class="dv">1</span> ; nc <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb44-44"><a href="abundance.html#cb44-44" aria-hidden="true" tabindex="-1"></a>Model_samples <span class="ot">&lt;-</span> <span class="fu">runMCMC</span>(<span class="at">mcmc =</span> Comp_Model, </span>
<span id="cb44-45"><a href="abundance.html#cb44-45" aria-hidden="true" tabindex="-1"></a>                         <span class="at">niter =</span> ni, </span>
<span id="cb44-46"><a href="abundance.html#cb44-46" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nburnin =</span> ni<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb44-47"><a href="abundance.html#cb44-47" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nchains =</span> nc,</span>
<span id="cb44-48"><a href="abundance.html#cb44-48" aria-hidden="true" tabindex="-1"></a>                         <span class="at">summary =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-49"><a href="abundance.html#cb44-49" aria-hidden="true" tabindex="-1"></a><span class="co">#mcmc_combo(Model_samples$samples, pars = c(&quot;N&quot;, &quot;p&quot;))</span></span>
<span id="cb44-50"><a href="abundance.html#cb44-50" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(Model_samples<span class="sc">$</span>summary<span class="sc">$</span>all.chains,<span class="dv">2</span>)</span></code></pre></div>
</div>
</div>
<div id="Stan_Huggins_mod" class="tabcontent">
<div id="section-14" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="abundance.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb45-2"><a href="abundance.html#cb45-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb45-3"><a href="abundance.html#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span>observed,</span>
<span id="cb45-4"><a href="abundance.html#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsites=</span><span class="fu">nrow</span>(observed),</span>
<span id="cb45-5"><a href="abundance.html#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">MNKA=</span>MNKA,</span>
<span id="cb45-6"><a href="abundance.html#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_occ=</span>n_occ</span>
<span id="cb45-7"><a href="abundance.html#cb45-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-8"><a href="abundance.html#cb45-8" aria-hidden="true" tabindex="-1"></a>stan_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb45-9"><a href="abundance.html#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb45-10"><a href="abundance.html#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; MNKA;</span></span>
<span id="cb45-11"><a href="abundance.html#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; nsites;</span></span>
<span id="cb45-12"><a href="abundance.html#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; n_occ;</span></span>
<span id="cb45-13"><a href="abundance.html#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0,upper=1&gt; y[MNKA, n_occ];</span></span>
<span id="cb45-14"><a href="abundance.html#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb45-15"><a href="abundance.html#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb45-16"><a href="abundance.html#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="st">  real&lt;lower=0, upper=1&gt; p;</span></span>
<span id="cb45-17"><a href="abundance.html#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb45-18"><a href="abundance.html#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="st">model {  </span></span>
<span id="cb45-19"><a href="abundance.html#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="st"> for(i in 1:nsites)</span></span>
<span id="cb45-20"><a href="abundance.html#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="st">    for(j in 1:4)</span></span>
<span id="cb45-21"><a href="abundance.html#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="st">      target += bernoulli_lpmf(y[i, j] | p);</span></span>
<span id="cb45-22"><a href="abundance.html#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb45-23"><a href="abundance.html#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb45-24"><a href="abundance.html#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="st">  real pstar = (1-(1-p)^n_occ);</span></span>
<span id="cb45-25"><a href="abundance.html#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="st">  real N = MNKA / pstar;</span></span>
<span id="cb45-26"><a href="abundance.html#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb45-27"><a href="abundance.html#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb45-28"><a href="abundance.html#cb45-28" aria-hidden="true" tabindex="-1"></a>ni <span class="ot">&lt;-</span> <span class="dv">10000</span> ; nt <span class="ot">&lt;-</span> <span class="dv">1</span> ; nc <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb45-29"><a href="abundance.html#cb45-29" aria-hidden="true" tabindex="-1"></a>stan.samples <span class="ot">&lt;-</span> <span class="fu">stan</span>(<span class="at">model_code =</span> stan_model, </span>
<span id="cb45-30"><a href="abundance.html#cb45-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> data, </span>
<span id="cb45-31"><a href="abundance.html#cb45-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">iter =</span> ni, </span>
<span id="cb45-32"><a href="abundance.html#cb45-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">warmup =</span> <span class="fu">floor</span>(ni<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb45-33"><a href="abundance.html#cb45-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chains =</span> nc, </span>
<span id="cb45-34"><a href="abundance.html#cb45-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">cores =</span> nc)</span></code></pre></div>
</div>
</div>
<div id="Greta_Huggins_mod" class="tabcontent">
<div id="section-15" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="abundance.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb46-2"><a href="abundance.html#cb46-2" aria-hidden="true" tabindex="-1"></a>reticulate<span class="sc">::</span><span class="fu">use_condaenv</span>(<span class="st">&quot;r-reticulate&quot;</span>)</span>
<span id="cb46-3"><a href="abundance.html#cb46-3" aria-hidden="true" tabindex="-1"></a>reticulate<span class="sc">::</span><span class="fu">py_config</span>()</span>
<span id="cb46-4"><a href="abundance.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(greta)</span>
<span id="cb46-5"><a href="abundance.html#cb46-5" aria-hidden="true" tabindex="-1"></a>capture_vec <span class="ot">&lt;-</span> <span class="fu">unlist</span>(observed)</span>
<span id="cb46-6"><a href="abundance.html#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># priors</span></span>
<span id="cb46-7"><a href="abundance.html#cb46-7" aria-hidden="true" tabindex="-1"></a>p_greta <span class="ot">&lt;-</span> <span class="fu">beta</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb46-8"><a href="abundance.html#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood</span></span>
<span id="cb46-9"><a href="abundance.html#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="fu">distribution</span>(capture_vec) <span class="ot">&lt;-</span> <span class="fu">bernoulli</span>(p_greta)</span>
<span id="cb46-10"><a href="abundance.html#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co"># derived parameters</span></span>
<span id="cb46-11"><a href="abundance.html#cb46-11" aria-hidden="true" tabindex="-1"></a>pstar <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> p_greta)<span class="sc">^</span>n_occ</span>
<span id="cb46-12"><a href="abundance.html#cb46-12" aria-hidden="true" tabindex="-1"></a>N_hat <span class="ot">&lt;-</span> MNKA <span class="sc">/</span> pstar</span>
<span id="cb46-13"><a href="abundance.html#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co"># defining the model</span></span>
<span id="cb46-14"><a href="abundance.html#cb46-14" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">model</span>(p_greta, N_hat, pstar)</span>
<span id="cb46-15"><a href="abundance.html#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co"># sampling</span></span>
<span id="cb46-16"><a href="abundance.html#cb46-16" aria-hidden="true" tabindex="-1"></a>ni <span class="ot">&lt;-</span> <span class="dv">10000</span> ; nt <span class="ot">&lt;-</span> <span class="dv">1</span> ; nc <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb46-17"><a href="abundance.html#cb46-17" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> greta<span class="sc">::</span><span class="fu">mcmc</span>(<span class="at">model =</span> m, </span>
<span id="cb46-18"><a href="abundance.html#cb46-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">n_samples =</span> ni,</span>
<span id="cb46-19"><a href="abundance.html#cb46-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">thin =</span> nt,</span>
<span id="cb46-20"><a href="abundance.html#cb46-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">warmup =</span> <span class="fu">floor</span>(ni<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb46-21"><a href="abundance.html#cb46-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chains =</span> nc, </span>
<span id="cb46-22"><a href="abundance.html#cb46-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">n_cores =</span> nc)</span></code></pre></div>
</div>
</div>
<div id="Pymc3_LP_mod" class="tabcontent">
<div id="section-16" class="section level4 unnumbered">
<h4 class="unnumbered"></h4>
<p><br></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="abundance.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> Model() <span class="im">as</span> model:  <span class="co"># model specifications in PyMC3 are wrapped in a with-statement</span></span>
<span id="cb47-2"><a href="abundance.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Priors for unknown model parameters</span></span>
<span id="cb47-3"><a href="abundance.html#cb47-3" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> pm.Uniform(<span class="st">&#39;p&#39;</span>, <span class="fl">0.</span>, <span class="fl">1.</span>)</span>
<span id="cb47-4"><a href="abundance.html#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Likelihood (sampling distribution) of observations</span></span>
<span id="cb47-5"><a href="abundance.html#cb47-5" aria-hidden="true" tabindex="-1"></a>    pstar <span class="op">=</span>  <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)</span>
<span id="cb47-6"><a href="abundance.html#cb47-6" aria-hidden="true" tabindex="-1"></a>    N_hat <span class="op">=</span>  pm.Deterministic(<span class="st">&quot;N_hat&quot;</span>, MNKA <span class="op">/</span> pstar)</span>
<span id="cb47-7"><a href="abundance.html#cb47-7" aria-hidden="true" tabindex="-1"></a>    Y_obs <span class="op">=</span> pm.Bernoulli(<span class="st">&quot;Y_obs&quot;</span>, p <span class="op">=</span> p, observed<span class="op">=</span>Y)</span>
<span id="cb47-8"><a href="abundance.html#cb47-8" aria-hidden="true" tabindex="-1"></a>    trace <span class="op">=</span> pm.sample()</span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="abundance.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> model:     </span>
<span id="cb48-2"><a href="abundance.html#cb48-2" aria-hidden="true" tabindex="-1"></a>  display(az.summary(trace, round_to <span class="op">=</span> <span class="dv">2</span>))</span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="comparison-1" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Comparison</h3>
</div>
</div>
<div id="data-augmentation" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Data Augmentation</h2>
</div>
<div id="n-mixture-model" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> N-Mixture Model</h2>
</div>
<div id="distance-sampling" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Distance Sampling</h2>
</div>
<div id="spatial-capture-recapture" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Spatial Capture-Recapture</h2>
</div>
<div id="time-to-event" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Time to Event</h2>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-alho_logistic_1990" class="csl-entry">
Alho, J. M. 1990. <span>“Logistic Regression in Capture–Recapture Models.”</span> <em>Biometrics</em> 46 (3): 623–35.
</div>
<div id="ref-huggins_statistical_1989" class="csl-entry">
Huggins, R. M. 1989. <span>“On the <span>Statistical</span> <span>Analysis</span> of <span>Capture</span> <span>Experiments</span>.”</span> <em>Biometrika</em> 76 (1): 133–40. <a href="https://doi.org/10.2307/2336377">https://doi.org/10.2307/2336377</a>.
</div>
<div id="ref-huggins_practical_1991" class="csl-entry">
———. 1991. <span>“Some <span>Practical</span> <span>Aspects</span> of a <span>Conditional</span> <span>Likelihood</span> <span>Approach</span> to <span>Capture</span> <span>Experiments</span>.”</span> <em>Biometrics</em> 47 (2): 725–32. <a href="https://doi.org/10.2307/2532158">https://doi.org/10.2307/2532158</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="occupancy.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"share": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Quantitative_Ecology_Desktop.pdf", "Quantitative_Ecology_Desktop.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
